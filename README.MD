# Лабораторная 2

Для каждого задания необходимо создать отдельный проект в соответствующей папке внутри solution.

## Задание 1

### Отрабатываемый материал

- **HTTP**, **Refit**

### Задача

Реализовать клиент для внешнего сервиса конфигураций, позволяющий получить список конфигурационных элементов.

Реализация стороннего сервиса конфигураций доступна в репозитории [lab-2-tools](https://github.com/is-csms-y26/lab-2-tools).  
В данном репозитории уже присутствует собранный в Docker образ сервис конфигураций, а также предоставлен файл [docker-compose](https://github.com/is-csms-y26/lab-2-tools/blob/master/docker-compose.yaml), который разворачивает сервис и базу данных.  
Вам необходимо:
- Скопировать файл `docker-compose.yaml` в папку `scr/lab-2` вашего репозитория.
- Добавить его в solution папку `src/lab-2`.
  
Сервис имеет Swagger документацию по пути `/swagger`, которую можно использовать для сидинга данных.

### Функциональные требования

- Реализовать интерфейс для выгрузки всех конфигураций из сервиса конфигураций.

### Нефункциональные требования

- Реализация должна содержать две версии клиента:
  1. С ручной реализацией запросов на базе `HttpClient`.
  2. С использованием **Refit**.
- Основной интерфейс не должен зависеть от Refit.
- Выгрузка конфигураций должна быть пагинированной.
- Размер загружаемой страницы должен быть параметризуемым.
- В ручной реализации `HttpClient` должен извлекаться при помощи `IHttpClientFactory`.
- Должны быть предоставлены методы расширения для регистрации обеих реализаций в DI контейнере (по одному методу на реализацию).

## Задание 2

### Отрабатываемый материал

- **Microsoft.Extensions.Configuration**
- **ConfigurationProvider**

### Задача

Реализовать кастомный `ConfigurationProvider`, получающий конфигурации из сервиса, созданного в Задании 1, и предоставляющий их в систему конфигурации приложения.

### Нефункциональные требования

- Реализовать сервис, обслуживающий данный провайдер. Сервис должен получать конфигурации от клиента и передавать их провайдеру.
- Сам провайдер не должен самостоятельно обращаться к клиентам.
- Сервис должен периодически обновлять конфигурации (например, с помощью `PeriodicTimer`).
- Интервал обновления должен быть параметризуемым.
- Провайдер не должен перезагружать конфигурации, если в них не было изменений.

### Тестовые сценарии

1. **Сценарий 1**  
   **Arrange**: Провайдер не имеет ключей конфигураций.  
   **Act**: Передать провайдеру один конфигурационный элемент.  
   **Assert**: Провайдер содержит пару ключ-значение, соответствующую переданному элементу, и обновляет конфигурацию.

2. **Сценарий 2**  
   **Arrange**: Провайдер содержит единственную пару ключ-значение.  
   **Act**: Передать провайдеру тот же самый элемент конфигурации.  
   **Assert**: Провайдер не вызывает обновление конфигурации (нет изменений).

3. **Сценарий 3**  
   **Arrange**: Провайдер содержит единственную пару ключ-значение.  
   **Act**: Передать провайдеру элемент с тем же ключом, но изменённым значением.  
   **Assert**: Провайдер обновляет значение по ключу и вызывает обновление конфигурации.

4. **Сценарий 4**  
   **Arrange**: Провайдер содержит единственную пару ключ-значение.  
   **Act**: Передать провайдеру пустую коллекцию конфигураций.  
   **Assert**: Провайдер становится пустым и обновляет конфигурацию.

> Признаком обновления конфигурации может служить вызов `OnReload` и изменение данных, с которыми он работает.

## Задание 3

### Отрабатываемый материал

- **Npgsql**, **Postgres**
- **Serialization**
- **Options**

### Задача

Реализовать репозитории, миграции и сервис для 
