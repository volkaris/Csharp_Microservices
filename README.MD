# Лабораторная 4

## Отрабатываемый материал

**Явное межсервисное взаимодействие, gRPC**

## Задача

**Что сделано:**
- **Добавил gRPC API для сервиса заказов из Лабораторной 3:**
  Предоставил возможность взаимодействия с функционалом сервиса заказов через gRPC, включая создание, обновление статуса, добавление и удаление товаров, а также получение истории заказов.
- **Реализовал отдельное ASP.NET приложение – HTTP гейтвей:**
  Гейтвей перенаправляет HTTP-запросы к gRPC сервису, упрощая интеграцию с клиентами, не поддерживающими gRPC напрямую.
- **Подключил gRPC клиент через Options:**
  Конфигурация доступа к gRPC сервису (адреса, настройки) передаются через Microsoft.Extensions.Options, обеспечивая гибкую настройку.

## Нефункциональные требования

**Что сделано:**
- **Полиморфизм моделей в gRPC API через `oneof`:**
  Структуры данных с возможными вариантами типов были реализованы при помощи `oneof`, обеспечивая строго-типизированную сериализацию/десериализацию.
- **Swagger документация для HTTP гейтвея:**
  Гейтвей документирован с помощью Swagger, включая подробное описание эндпоинтов, возможных ответов и типов данных.
- **Полиморфные модели в HTTP гейтвее – без `oneof`:**
  В HTTP гейтвее полиморфизм реализован без `oneof`, используя иные способы описания моделей, что упрощает работу с JSON клиентам без gRPC.
- **Server Interceptor для обработки ошибок в gRPC сервисе:**
  В gRPC сервисе внедрён перехватчик (Interceptor), отвечающий за единообразный формат ошибок, возвращаемых клиентам.
- **Middleware для преобразования gRPC исключений в конкретные HTTP коды:**
  В HTTP гейтвее реализован middleware, перехватывающий gRPC исключения и маппящий их в соответствующие HTTP статусы и сообщения. Это повышает удобство интеграции для REST-клиентов, получающих предсказуемые коды ошибок.

Таким образом, сервис заказов был расширен gRPC API, а также создан HTTP гейтвей, предоставляющий удобный REST-подход для клиентов. При этом сохранена возможность конфигурирования через Options, реализован единый формат ошибок, документированы эндпоинты и модели, а полиморфизм корректно отражён в обоих интерфейсах.  
