# Лабораторная работа

## Задание 1

**Реализовано:**

- **Метод расширения для `IEnumerable<T>` и `IAsyncEnumerable<T>`**, выполняющий операцию объединения (склейки) коллекций по аналогии с `Zip` из LINQ.
- Использование параметра `params` для объединения динамического числа коллекций.
- Корректная утилизация ресурсов при работе с итераторами и перечислителями.
- Обработка ситуаций, когда длины коллекций не совпадают, с собственной стратегией решения.
- **Тесты:** Написаны с использованием **XUnit** и **FluentAssertions**, проверяют различные сценарии — от отсутствия дополнительных коллекций до случаев, где длины источников различаются.

## Задание 2

**Реализовано:**

- **Асинхронный клиент (`IRequestClient`)** с поддержкой `async/await` для взаимодействия со сторонним сервисом, изначально предоставляющим реактивный интерфейс.
- Реализация интерфейса `ILibraryOperationHandler` для обработки результатов и ошибок, а также корректной поддержки отмены операций (`CancellationToken`).
- Гарантия корректной работы в многопоточной среде, защита от `race condition`, включая сценарии мгновенной отмены или быстрого завершения операции до запуска.
- При отмене операции корректно генерируется `TaskCancelledException`, чтобы исключить бесконционное ожидание.
- **Тесты:** Использование **XUnit**, **FluentAssertions** и **NSubstitute** для проверки корректного поведения — от успешной передачи результата и обработки ошибок до проверки механизма отмены.

## Задание 3

**Реализовано:**

- Система асинхронной обработки сообщений на основе **каналов** (`System.Threading.Channels`):
  - Механизм отправки сообщений из нескольких потоков.
  - Обработка в одном потоке с применением батчинга.
- Класс `MessageProcessor`, реализующий `IMessageSender` (запись сообщений) и `IMessageProcessor` (их последующая обработка).
- Гибкая настройка параметров: размер очереди канала, размер батча, таймауты и пр.
- Применение батч-обработки с помощью метода `ChunkAsync` из внешнего пакета для минимизации числа системных вызовов (`Console.WriteLine`).
- При переполнении канала самые старые сообщения удаляются, чтобы не блокировать отправителей.
- **Демонстрационный скрипт**:
  - Параллельная отправка сообщений с `Parallel.ForEachAsync`.
  - Запуск обработки через `ProcessAsync`.
  - Завершение обработки посредством вызова `Complete`.
  - По итогу — вывод всех сообщений и корректное завершение работы.

---

**Итог:**  
Выполненные задания демонстрируют владение технологиями .NET, LINQ, асинхронностью (`async/await`), каналами, написанием тестов (XUnit, FluentAssertions), мокированием зависимостей (NSubstitute) и организацией многопоточных операций с использованием современных механизмов языка C#.
